# プロジェクトの技術スタックと実行方法

## 技術スタック

### ハードウェア
- **マイクロコントローラー**: ESP32
- **サーボモーター**:
  - RDS3218: 最初の4つのサーボ（ID: 0, 1, 2, 3）
    - パルス幅設定: 500-2500μs
  - SG-5010: 残りの2つのサーボ（ID: 4, 5）
    - パルス幅設定: 1000-2000μs

### ソフトウェア
- **開発環境**: Arduino IDE または PlatformIO
- **プログラミング言語**:
  - C/C++（Arduino スケッチ）
  - Python（BLEクライアント）
- **ライブラリ**:
  - ESP32 Arduino Core
  - ESP32Servo
  - BLEDevice
  - BLEServer
  - BLEUtils
  - BLE2902
  - Python Bleak（BLE通信用）

## プログラムの実行方法

### Arduino スケッチのアップロード
1. Arduino IDEまたはPlatformIOをインストール
2. ESP32ボードマネージャーをインストール
3. 必要なライブラリをインストール
4. ESP32をUSBケーブルでPCに接続
5. 適切なボードとポートを選択
6. スケッチをコンパイルしてアップロード
   - 注意: ESP32のブートモードに入るには、場合によってはBOOTボタンを押す必要がある
   - 注意: ピン12を外す必要がある場合がある（README.mdに記載）

### Pythonクライアントの実行
1. 仮想環境を作成して有効化
   ```
   python3 -m venv env
   source env/bin/activate
   ```

2. 必要なライブラリをインストール
   ```
   pip install -r requirements.txt
   ```

3. BLECentral.pyを実行
   ```
   python3 BLECentral.py
   ```

## サーボモーターの制御

### コマンド形式
- "ID ANGLE" の形式でコマンドを送信
  - ID: サーボモーターのID（1-6）
  - ANGLE: 設定する角度（度）

### 角度の範囲
- サーボモーターの稼働範囲は以下の通り:
  - ID 1: 0° ~ 270°（デフォルト: 135°）
  - ID 2: 30° ~ 240°（デフォルト: 135°）
  - ID 3: 30° ~ 240°（デフォルト: 135°）
  - ID 4: 30° ~ 240°（デフォルト: 135°）
  - ID 5: 0° ~ 180°（デフォルト: 135°）
  - ID 6: 0° ~ 180°（デフォルト: 135°）

### 注意事項
- RDS3218サーボモーター（ID: 0-3）は内部で角度調整（×2/3）が行われる
  - 例：135度に設定したい場合、実際には90度（= 135 × 2/3）の値が書き込まれる
  - この調整はsetup関数内の初期化時とmoveServo関数内の両方で行われる
- RDS3218とSG-5010ではパルス幅設定が異なる
  - RDS3218: 500-2500μs（より広い範囲）
  - SG-5010: 1000-2000μs（標準的な範囲）
- 角度の変更が大きい場合、サーボモーターの移動に時間がかかる
- ESP32のピン配置に注意（35, 34は入力専用）
